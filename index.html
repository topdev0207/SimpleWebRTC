<html>
    <head>
        <title>Webrtc.js Demo</title>
    </head>
    <body>
        <input id="sessionInput"/><button id="addSession">add other session</button>
        <video id="localVideo" style="border: 1px solid black; height: 100px; width: 150px"></video>
        <div id="remotes"></div>
        <p>Someone can call you by visiting this page: <span id="link"></span></p>
        <p>Your session id: <span id="sessionIdEl"></span></p>
        <script src="http://tool.andyet.net:8888/socket.io/socket.io.js"></script>
        <script src="webrtc.js"></script>
        <script>
            // get our link element (we'll put our connection ID in there)
            var link = document.getElementById('link'),
                userWeWantToCall = location.search && location.search.split('?')[1];

            // create our webrtc connection
            var connection = new WebRTC();

            // if wewhen it's ready call if we've got an id in our URL
            connection.on('readyToCall', function (sessionId) {
                // here we just create a link that can be used to call you
                var url = location.href + '?' + sessionId;
                
                sessionIdEl.innerHTML = sessionId;
                link.innerHTML = url;

                // if we've got an id in the url, start the call
                if (userWeWantToCall) {
                    connection.startVideoCall(userWeWantToCall);
                }
            });

            connection.startLocalVideo(localVideo);

            addSession.addEventListener('click', function () {
                connection.startVideoCall(sessionInput.value.trim());
                sessionInput.value = '';
            });

        </script>
    </body>
</html>
